<!DOCTYPE html>
<html lang="en">
<head>
  <title>Nerd</title>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css">
  <style type="text/css">
    #editor {
      position: relative;
      width: 100%;
      height: 560px;
    }
  </style>
</head>
<body>

<div class="container-fluid">
  <div class="row-fluid">
    {{ content|raw }}
  </div>
</div>
</body>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
<script src="//d1n0x3qji82z53.cloudfront.net/src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
  var editor = ace.edit("editor")
      editor.setTheme("ace/theme/monokai")
      editor.getSession().setMode("ace/mode/html")
      editor.getSession().setTabSize(2)
      editor.getSession().setUseSoftTabs(true)
      editor.getSession().setUseWrapMode(false)
      editor.setHighlightActiveLine(true)
      editor.setShowPrintMargin(false)

  var ActionsObj = function(editor) {
    this.editor = editor
    this.original = editor.getValue()
  }

  ActionsObj.prototype = {
    debug: function() {
      console.log(this.editor.getValue())
    },
    revert: function() {
      var confirm = window.confirm('Are you sure you wish to discard all of your changes?')
      if (confirm) this.editor.setValue(this.original)
    },
    save: function() {
      $.ajax({
        type: 'post',
        url: window.location.href,
        data: {
          save: true,
          content: this.editor.getValue()
        },
        dataType: 'json',
        success: function(result) {
          if (result.success) {
            alert('Content saved successfully')
          } else {
            alert('Content could not be saved: '.result.message)
          }
        }
      })
    }
  }

  var actions = new ActionsObj(editor)
</script>

</html>